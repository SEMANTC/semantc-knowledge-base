table: xero_accounts
description: "Semantic model for Xero Accounting API's accounts data."

columns:
  - name: account_id
    type: string
    primary_key: true
    description: "The Xero identifier for an account â€“ specified as a string following the endpoint name, e.g., /297c2dc5-cc47-4afd-8ec8-74990b8761e9."
    notes: "[optional]"

  - name: add_to_watchlist
    type: boolean
    description: "Boolean indicating whether the account is shown in the watchlist widget on the dashboard."
    notes: "[optional]"

  - name: bank_account_number
    type: string
    description: "For bank accounts only (Account Type BANK)."
    notes: "[optional]"

  - name: bank_account_type
    type: string
    description: "For bank accounts only. See Bank Account types."
    notes: "[optional]"

  - name: class
    type: string
    description: "See Account Class Types."
    notes: "[optional]"

  - name: code
    type: string
    description: "Customer defined alphanumeric account code e.g., 200 or SALES (max length = 10)."
    notes: "[optional]"

  - name: currency_code
    type: string
    description: "Currency code used for the account."
    notes: "[optional]"

  - name: description
    type: string
    description: "Description of the Account. Valid for all types of accounts except bank accounts (max length = 4000)."
    notes: "[optional]"

  - name: enable_payments_to_account
    type: boolean
    description: "Boolean describing whether the account can have payments applied to it."
    notes: "[optional]"

  - name: has_attachments
    type: boolean
    description: "Boolean to indicate if an account has an attachment (read only)."
    notes: "[optional] [default to False]"

  - name: name
    type: string
    description: "Name of the account (max length = 150)."
    notes: "[optional]"

  - name: reporting_code
    type: string
    description: "Reporting code shown if set."
    notes: "[optional]"

  - name: reporting_code_name
    type: string
    description: "Name of the reporting code shown if set."
    notes: "[optional]"

  - name: show_in_expense_claims
    type: boolean
    description: "Boolean describing whether the account code is available for use with expense claims."
    notes: "[optional]"

  - name: status
    type: string
    description: "Accounts with a status of ACTIVE can be updated to ARCHIVED. See Account Status Codes."
    notes: "[optional]"

  - name: system_account
    type: string
    description: "If this is a system account then this element is returned. See System Account types. Non-system accounts may have this element set as either \"\" or null."
    notes: "[optional]"

  - name: tax_type
    type: string
    description: "The tax type from TaxRates."
    notes: "[optional]"

  - name: type
    type: string
    description: "See Account Types."
    notes: "[optional]"

  - name: updated_date_utc
    type: timestamp
    description: "Last modified date in UTC format."
    notes: "[optional]"

  - name: validation_errors
    type: string
    description: "Displays array of validation error messages from the API."
    notes: "[optional]"

  - name: ingestion_time
    type: timestamp
    description: "Timestamp when the record was ingested into BigQuery."
    notes: "[optional]"

enumerations:
  status:
    allowed_values:
      - ACTIVE
      - ARCHIVED
      - DELETED
      - NONE

  bank_account_type:
    allowed_values:
      - BANK
      - CREDITCARD
      - PAYPAL
      - NONE
      - NULL

  class:
    allowed_values:
      - ASSET
      - EQUITY
      - EXPENSE
      - LIABILITY
      - REVENUE
      - NONE

  system_account:
    allowed_values:
      - DEBTORS
      - CREDITORS
      - BANKCURRENCYGAIN
      - GST
      - GSTONIMPORTS
      - HISTORICAL
      - REALISEDCURRENCYGAIN
      - RETAINEDEARNINGS
      - ROUNDING
      - TRACKINGTRANSFERS
      - UNPAIDEXPCLM
      - UNREALISEDCURRENCYGAIN
      - WAGEPAYABLES
      - CISASSETS
      - CISASSET
      - CISLABOUR
      - CISLABOUREXPENSE
      - CISLABOURINCOME
      - CISLIABILITY
      - CISMATERIALS
      - NONE

measures:
  - name: total_accounts
    description: "Total number of accounts."
    agg: count
    expr: account_id

  - name: active_accounts
    description: "Number of active accounts."
    agg: count
    expr: account_id
    filter: "{{ Dimension('status') }} = 'ACTIVE'"

  - name: archived_accounts
    description: "Number of archived accounts."
    agg: count
    expr: account_id
    filter: "{{ Dimension('status') }} = 'ARCHIVED'"

  - name: deleted_accounts
    description: "Number of deleted accounts."
    agg: count
    expr: account_id
    filter: "{{ Dimension('status') }} = 'DELETED'"

  - name: bank_accounts
    description: "Number of bank accounts."
    agg: count
    expr: account_id
    filter: "{{ Dimension('bank_account_type') }} = 'BANK'"

  - name: currency_account_count
    description: "Number of accounts per currency."
    agg: count
    expr: account_id
    group_by:
      - currency_code

  - name: system_accounts
    description: "Number of system accounts."
    agg: count
    expr: account_id
    filter: "{{ Dimension('system_account') }} != ''"

metrics:
  - name: total_accounts_metric
    description: "Total number of accounts."
    type: simple
    label: "Total Accounts"
    type_params:
      measure:
        name: total_accounts

  - name: active_accounts_metric
    description: "Total number of active accounts."
    type: simple
    label: "Active Accounts"
    type_params:
      measure:
        name: active_accounts

  - name: archived_accounts_metric
    description: "Total number of archived accounts."
    type: simple
    label: "Archived Accounts"
    type_params:
      measure:
        name: archived_accounts

  - name: deleted_accounts_metric
    description: "Total number of deleted accounts."
    type: simple
    label: "Deleted Accounts"
    type_params:
      measure:
        name: deleted_accounts

  - name: bank_accounts_metric
    description: "Total number of bank accounts."
    type: simple
    label: "Bank Accounts"
    type_params:
      measure:
        name: bank_accounts

  - name: currency_account_count_metric
    description: "Number of accounts per currency."
    type: simple
    label: "Currency Account Count"
    type_params:
      measure:
        name: currency_account_count

  - name: system_accounts_metric
    description: "Total number of system accounts."
    type: simple
    label: "System Accounts"
    type_params:
      measure:
        name: system_accounts

saved_queries:
  - name: account_summary
    description: "Summary of accounts with key metrics."
    label: "Account Summary"
    config:
      cache:
        enabled: true
    query_params:
      metrics:
        - total_accounts_metric
        - active_accounts_metric
        - archived_accounts_metric
        - deleted_accounts_metric
        - bank_accounts_metric
        - currency_account_count_metric
        - system_accounts_metric
      group_by:
        - Dimension('currency_code')
        - TimeDimension('updated_date_utc', 'month')
      where:
        - "{{ Dimension('status') }} != 'DELETED'"
    exports:
      - name: account_summary_export
        config:
          export_as: table
          schema: analytics
          alias: account_summary_table

config:
  enabled: true
  group: "Xero Accounts"
  meta:
    owner: "fernando@abcdataz.com"
    last_updated: "2024-04-27"